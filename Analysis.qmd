---
title: "Analysis"
format: html
editor: visual
author: 'Yifan Wu, Hongyu Jing'
---

## Input dataset

```{r}
library(readxl)
dat<- read_xls("SAP2020_merged_v1.xls")
dat[1:5,]
```

The dataset is the agronomic traits that were measured in a sorghum field experiment with two levels of nitrogen treatment and around 400 genotypes. Hopefully we will also find the sub-population information of these genotypes as an additional categorical attribute.\

Each row represents a small pieces of land with it's unique row number and column number which contains around 10 individual sorghum plants. The explanation for each column stated below:\

**Plot ID&Sorghum Accession:** Unique ID for each plants\

**SNPDataIDï¼š** Unique ID\

**Row&Column:** spatial data for sorghum plants\

**Block:** Blocking number\

**Treatment:** two levels of nitrogen treatment\

**DaysToBloom:** How many days until the sorghum flower bloom(unit:day)\

**MedianLeafAngle:** Median value of leaf angle for each 10 individual sorghum plants(unit:degree)\

**LeafAngleSDV:** Standard deviation of leaf angle for 10 individual sorghum plants\

**PoorStand:** If half of the sorghum plants are poor stand, if yes then the answer is Y\

**PaniclesPerPlot:** How many panicles per plot have\

**PanicleGrainWeight:** How much grain weight for each panicle(unit:gram)\

**EstimatedPlotYield:** The estimated plot yield for 10 individual sorghum plants(unit:gram)\

**FlagLeafLength:** The mean value of the flag leaf's length for each 10 individual sorghum plants(unit: cm)\

**FlagLeafWidth:** The mean value of the flag leaf's width for each 10 individual sorghum plants(unit: cm)\

**ExtantLeafNumber:** The number of visible leaves on the main stalk at maturity stage.\

**PlantHeight:**The mean value of the plant height for each 10 individual sorghum plants(unit: cm)\

**ThirdLeafLength:** The mean value of the third leaf's length for each 10 individual sorghum plants(unit: cm)\

**ThirdLeafWidth:** The mean value of the third leaf's width for each 10 individual sorghum plants(unit: cm)\

## data cleaning

```{r}
##delete the useless column

newdat<- dat[,c(-1,-3)]

##there exist missing data in several rows at different column, we will rearrange it during analysis
```

## data exploring

```{r}
summary(newdat)
```
## Data analysis
### 1. check the distribution for numeric output column
#### 1.1 box plot for leaf dimension
```{r}
library(ggplot2)
library(dplyr)
require(reshape2)
library(tidyr)


###select leaf dimention data to plot a box plot
###select required column
analysis_le<- newdat[,c(13,14,17,18)]
###clean navalue
clean_le<- analysis1%>%
  melt()%>%
  ###cleaning na value
  drop_na(value)

###plot box plot
ggplot(clean_a1,aes(x=variable, y=value))+
  geom_boxplot()


  

```
Based on the plot above, we can see that overall the dimension of the third leaf is larger than the flag leaf which is reasonable.
#### 1.2 histogram for blooming day

```{r}
##create some histogram for each variable to have a basic understand for each variable

###blooming date
analysis_bloom<-melt(newdat[,c(6)])

###clean navalue
clean_bloom<- analysis_bloom%>%
  ###cleaning na value
  drop_na(value)

###plot box plot
ggplot(clean_bloom,aes(x=value))+
  geom_histogram(binwidth = 2)


```
Based on the histogram above, we know that usually it takes around 50 to 80 days for the sorghum flower bloom.The highest probability range is around 60 to 70 days.
#### 1.3 histogram for median leaf angle
```{r}

analysis_angle<-melt(newdat[,c(7)])

###clean navalue
clean_angle<- analysis_angle%>%
  ###cleaning na value
  drop_na(value)

###plot box plot
ggplot(clean_angle,aes(x=value))+
  geom_histogram(binwidth = 2)

```
Based on the histogram above, we know that usually the median value of leaf angle for each 10 individual sorghum plants is around 40 to 45 degree.
#### 1.4 histogram for panicle amount
```{r}

analysis_panicle<-melt(newdat[,c(10)])

###clean navalue
clean_panicle<- analysis_panicle%>%
  ###cleaning na value
  drop_na(value)

###plot box plot
ggplot(clean_panicle,aes(x=value))+
  geom_histogram(binwidth = 2)

```
Based on the histogram above, we know that usually the panicles per plot have is around 0 to 20 where the highest possibility is around 13.
####1.5 histogram for grain weight
```{r}

analysis_grain<-melt(newdat[,c(11)])

###clean navalue
clean_grain<- analysis_grain%>%
  ###cleaning na value
  drop_na(value)

###plot box plot
ggplot(clean_grain,aes(x=value))+
  geom_histogram(binwidth = 5)

```
Based on the histogram above, we know that usually the grain weight for each panicle is around 0 to 50 grams.
####1.6 histogram for yield
```{r}

analysis_yield<-melt(newdat[,c(12)])

###clean navalue
clean_yield<- analysis_yield%>%
  ###cleaning na value
  drop_na(value)

###plot box plot
ggplot(clean_yield,aes(x=value))+
  geom_histogram(binwidth = 50)

```

Based on the histogram above, we know that the estimated plot yield for 10 individual sorghum plants is around 0 to 1000 grams where the highest possibility range is around 300 to 500 gram.
####1.7 histogram for plant height
```{r}

analysis_grain<-melt(newdat[,c(11)])

###clean navalue
clean_grain<- analysis_grain%>%
  ###cleaning na value
  drop_na(value)

###plot box plot
ggplot(clean_grain,aes(x=value))+
  geom_histogram(binwidth = 5)

```
Based on the histogram above, we know that usually the grain weight for each panicle is around 0 to 50 grams.
####1.6 histogram for yield
```{r}

analysis_height<-melt(newdat[,c(16)])

###clean navalue
clean_height<- analysis_height%>%
  ###cleaning na value
  drop_na(value)

###plot box plot
ggplot(clean_height,aes(x=value))+
  geom_histogram(binwidth = 10)

```
Based on the histogram above, we know range for plot height is around 30 to 300cm where usually the height will be around 70 cm.
###2.Explore the effect of the nitrogen treatment for leaf dimension/plant height/yield
####2.1 plant height
```{r}
effect_height<-newdat[,c(5,16)]
###clean navalue
clean_eff_height<- effect_height%>%
  ###cleaning na value
  drop_na(PlantHeight)

ggplot(clean_eff_height, aes(x=Treatment, y=PlantHeight))+
  geom_boxplot()

```
```{r}
effect_height<-newdat[,c(5,16)]
###clean navalue
clean_eff_height<- effect_height%>%
  ###cleaning na value
  drop_na(PlantHeight)

ggplot(clean_eff_height, aes(x=Treatment, y=PlantHeight))+
  geom_boxplot()

```



